## Scala Breeze 程序包简介

**Breeze** 是 Scala 中常用的 **数值计算与线性代数库**，功能类似于 Python 的 NumPy / SciPy，广泛用于机器学习、数值优化和 Spark 相关计算。

### Breeze 的主要功能

- **线性代数**
    - 向量、矩阵（Dense / Sparse）
    - 转置、矩阵乘法、对角矩阵、单位矩阵等
- **数值计算**
    - 常见数学函数（`exp`、`log`、`sqrt` 等）
- **统计与随机**
    - 均值、方差、概率分布、随机采样

### 常用导入方式
```scala
import breeze.linalg._ import breeze.numerics._
```

## 常用方法

### 向量和矩阵的创建

| 创建方法   | Breeze 写法                                           | 示例                                                         |
| ------ | --------------------------------------------------- | ---------------------------------------------------------- |
| 零矩阵    | `DenseMatrix.zeros[Double](n, m)`                   | `val A = DenseMatrix.zeros[Double](2, 3)`                  |
| 零向量    | `DenseVector.zeros`                                 |                                                            |
| 常数向量   | `DenseVector.ones`                                  |                                                            |
| 任意常数向量 | `DenseVector.fill(n){a}`                            | `val v = DenseVector.fill(3){2.5}`                         |
| 固定步长向量 | `DenseVector.range(start, stop, step)`              | `val v = DenseVector.range(0, 10, 2)`                      |
|        | `Vector.ranged(start, stop, step)`                  | `val v = Vector.ranged(1, 5, 1)`                           |
| 固定长度向量 | `linspace(start, stop, num)`                        | `val v = linspace(0.0, 1.0, 5)`                            |
| 单位矩阵   | `DenseMatrix.eye`                                   |                                                            |
| 对角矩阵   | `diag(DenseVector(a,b,c))`                          | `val D = diag(DenseVector(1.0, 2.0, 3.0))`                 |
| 任意矩阵   | `DenseMatrix((a,b),(c,d))`                          | `val M = DenseMatrix((1.0,2.0),(3.0,4.0))`                 |
| 任意列向量  | `DenseVector(a,b,c)`                                | `val v = DenseVector(1.0, 2.0, 3.0)`                       |
| 任意行向量  | `DenseVector(a,b,c).t`                              | `val r = DenseVector(1.0,2.0,3.0).t`                       |
| 向量函数   | `DenseVector.tabulate(n){ i => f(i) }`              | `val v = DenseVector.tabulate(5)(i => i * i)`              |
| 矩阵函数   | `DenseMatrix.tabulate(n,m){ case (i,j) => f(i,j) }` | `val M = DenseMatrix.tabulate(2,3){ case (i,j) => i + j }` |
- Breeze 中：
  - `DenseVector` 默认是 **列向量**
  - `.t` 表示转置，得到 **行向量**
- `range` 是 **离散步长**
- `linspace` 是 **等分区间**
- `tabulate` 非常适合：
  - 构造数学定义的向量 / 矩阵
  - 写得像公式一样清晰


### 常用矩阵和向量的处理方法

| 处理方法         | Breeze 写法                   | 示例                                  |
| ------------ | --------------------------- | ----------------------------------- |
| 拉直矩阵 A       | `A.toDenseVector`           | `val v = A.toDenseVector`           |
| 矩阵 A 变形      | `A.reshape(n, m)`           | `val B = A.reshape(3, 2)`           |
| 取出矩阵 A 对角元素  | `diag(A)`                   | `val d = diag(A)`                   |
| 矩阵 A, B 水平合并 | `DenseMatrix.horzcat(A, B)` | `val C = DenseMatrix.horzcat(A, B)` |
| 矩阵 A, B 垂直合并 | `DenseMatrix.vertcat(A, B)` | `val C = DenseMatrix.vertcat(A, B)` |
| 向量 a, b 合并   | `DenseVector.vertcat(a, b)` | `val v = DenseVector.vertcat(a, b)` |
- `A.toDenseVector`
  - 按 **列优先（column-major）** 拉直矩阵
  - 与 Breeze 内部存储方式一致

- `reshape(n, m)`
  - **不改变数据顺序**
  - 只是重新解释形状
  - 元素总数必须一致，否则报错

- `horzcat(A, B)`
  - 要求：A 和 B **行数相同**
  - 结果列数 = A.cols + B.cols

- `vertcat(A, B)`
  - 要求：A 和 B **列数相同**
  - 结果行数 = A.rows + B.rows


### 常用运算与线性代数处理

| 操作                | Breeze 写法             | 示例                                          |
| ----------------- | --------------------- | ------------------------------------------- |
| 相加                | `x + y`               | `val z = x + y`                             |
| 按元素相乘             | `x * y`               | `val z = x * y`                             |
| 递加                | `x += 1` 或 `x :+= 1`  | `x += 1`                                    |
| 递减                | `x -= 1` 或 `x :-= 1`  | `x :-= 1`                                   |
| 按元素递乘             | `x *= 2` 或 `x :*= 2`  | `x :*= 2`                                   |
| 按元素递除             | `x /= 2` 或 `x :/= 2`  | `x :/= 2`                                   |
| 向量乘积              | `x.t * y` 或 `x dot y` | `val s = x dot y`                           |
| 任意元素为真            | `any(x)`              | `any(x > 0.0)`                              |
| 所有元素为真            | `all(x)`              | `all(x >= 0.0)`                             |
| 行列式               | `det(x)`              | `val d = det(A)`                            |
| 矩阵逆               | `inv(x)`              | `val Ainv = inv(A)`                         |
| Moore-Penrose 广义逆 | `pinv(x)`             | `val Ap = pinv(A)`                          |
| Frobenius 范数      | `norm(x)`             | `val n = norm(A)`                           |
| 特征分解              | `eig(x)`              | `val eigSym.EigSym(vals, vecs) = eigSym(A)` |
| 奇异值分解             | `svd(x)`              | `val svd.SVD(u, s, v) = svd(A)`             |
| 矩阵秩               | `rank(x)`             | `val r = rank(A)`                           |

- `*`
  - 向量/矩阵中表示 **哈德曼积**（即按元素相乘）

- `x :+= y`
  - `:` 开头表示 **原地修改（in-place）**
  - 比 `x = x + y` 更高效

- `x dot y`
  - 结果是 **标量**
  - 等价于 `x.t * y`

- `inv(A)`
  - 要求 A 是 **方阵且可逆**
  - 不满足会抛异常

- `pinv(A)`
  - 支持 **非方阵 / 奇异矩阵**
  - 内部基于 SVD

